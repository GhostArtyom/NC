<< NCTr`

Module[
  {a,b,c,l},

  SNC[a,b,c];

  (* Test SortCyclicPermutation *)
  l = {b, a, c};
  NCTest[SortedCyclicPermutationQ[l], False];
  NCTest[SortCyclicPermutation[l, {}, 0], {2}];
  NCTest[l = SortCyclicPermutation[l], {a, c, b}];
  NCTest[SortedCyclicPermutationQ[l], True];

  l = {a, b, c, 1 + a, 1, a ** b};
  NCTest[SortedCyclicPermutationQ[l], False];
  NCTest[SortCyclicPermutation[l, {}, 0], {5}];
  NCTest[l = SortCyclicPermutation[l], {1, a ** b, a, b, c, 1 + a}];
  NCTest[SortedCyclicPermutationQ[l], True];

  l = {a, 1, b, c, 1 + 1, 1, a ** b};
  NCTest[SortedCyclicPermutationQ[l], False];
  NCTest[pos = SortCyclicPermutation[l, {}, 0], {2, 6}];
  NCTest[SortCyclicPermutation[l, pos, 1], {2}];
  NCTest[l = SortCyclicPermutation[l], {1, b, c, 2, 1, a ** b, a}];
  NCTest[SortedCyclicPermutationQ[l], True];

  l = {a, 1, a ** b, 1, c, 1 + 1, 1, b};
  NCTest[SortedCyclicPermutationQ[l], False];
  NCTest[pos = SortCyclicPermutation[l, {}, 0], {2, 4, 7}];
  NCTest[SortCyclicPermutation[l, pos, 1], {7}];
  NCTest[l = SortCyclicPermutation[l], {1, b, a, 1, a ** b, 1, c, 2}];
  NCTest[SortedCyclicPermutationQ[l], True];

  l = {a, 1, a ** b, 1, c, 1 + 1, 1, b, b, 1, b};
  NCTest[SortedCyclicPermutationQ[l], False];
  NCTest[pos = SortCyclicPermutation[l, {}, 0], {2, 4, 7, 10}];
  NCTest[pos = SortCyclicPermutation[l, pos, 1], {7, 10}];
  NCTest[SortCyclicPermutation[l, pos, 2], {10}];
  NCTest[l = SortCyclicPermutation[l], {1, b, a, 1, a ** b, 1, c, 2, 1, b, b}];
  NCTest[SortedCyclicPermutationQ[l], True];

  NCTest[pos = SortCyclicPermutation[l, {}, 0], {1, 4, 6, 9}];
  NCTest[pos = SortCyclicPermutation[l, pos, 1], {1, 9}];
  NCTest[SortCyclicPermutation[l, pos, 2], {1}];
  NCTest[l = SortCyclicPermutation[l], {1, b, a, 1, a ** b, 1, c, 2, 1, b, b}];
  NCTest[SortedCyclicPermutationQ[l], True];

  (* Test tr *)
  NCTest[tr[2], 2];
  NCTest[tr[2 a], 2 tr[a]];
  NCTest[tr[a], tr[a]];
  NCTest[List @@ tr[b ** a], {a ** b}];
  NCTest[List @@ tr[b ** a ** c], {a ** c ** b}];
  
  NCTest[tr[b ** a - a ** b], 0];
  NCTest[NCExpand[tr[b ** a - a ** (b - inv[a])]], 1];

  NCTest[tr[tp[a]], tr[a]];
  NCTest[List @@ tr[tp[a]**tp[b]], {a ** b}];
  NCTest[List @@ tr[a**tp[b]], {a ** tp[b]}];

  NCTest[List @@ tr[tp[a] ** b], {a ** b^T}];
  NCTest[List @@ tr[tp[a] ** tp[b]], {a ** b}];
  NCTest[List @@ tr[tp[b] ** tp[a]], {a ** b}];
  NCTest[List @@ tr[tp[b] ** a], {a ** b^T}];
  
  NCTest[List @@ tr[d ** c ** tp[a] ** b], {a ** c^T ** d^T ** b^T}];
  NCTest[List @@ tr[d ** a ** tp[d] ** b], {a ** d^T ** b ** d}];
  NCTest[List @@ tr[a ** b - tp[b ** a]], 0];

  NCTest[a ** b ** tr[a ** b], tr[a ** b] a ** b];

];